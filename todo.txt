TODO
	Library	
		I don't know if albums will form from tracks after they have loaded and been identified as not an album, then id3 tags edited.
	
		Sigur Ros () doesn't load.
		
		Albums aren't updating on the album list when you edit tags. Probably because they're behind in the update queue or I broke album.update
		
		Sometimes there are duplicated tracks in the track list
		
		When removing all sources, it takes a long time to remove everything (5+ seconds)
			This is because of the processWatcherEvents function taking lots of time on load. 
			
		Setup a currentList.updateAlbum and updatePlaylist system
			Doesn't change artwork
			CurrentplayingTrack is the same one
			updates data and locations
			
		Library load and unload time
		
	UI
		I need to fix the no-resize column thing for last columns. It's a bigger issue now that we can hide columns.
		
		persist column info
			sort options
			ordering
		
		Drag and drop folder onto current list isn't putting the songs in the right position
		
		missing-data isn't removed when a track is deleted, so if you D&D into the playlist, you see missing sometimes
		
		tracks with missing files are removed from the current list if you close and reopen hypnos. They should stay
						
		Sorting
			Table sort on Album (Disc 9) Album (Disc 10) is wrong - See Radiohead Towering above the rest
			http://www.davekoelle.com/alphanum.html
			
			Track Table Sort by - Is currently sorting by letter instead of by number.
							
		Library Source Directories - highlight in red if they are missing. 
		
		Overwite a playlist -> Get prompted -> Select "Yes" to save -> Hit cancel on the next dialog -> Thing is overwritten. Instead cancel the change.
		
		Make all alerts and prompts use theme
			FXUI.promptAndSavePlaylist
			FXUI.alertUser
									
		Export playlist as a folder
			Copy all of the music files into that folder. Prepend them with index number? 
			Warn if the total copy is larger than X MB or more than X tracks
	
		Volume Slider 
			doesn't feel right. Do some math formula instead of linear
			in windows goes past 100%
	
		Bug report dialog
	
		current list play/pause images don't change colors immediately. Have to play a new track to get updateImageThemes() to call.
		
		Add default sort column choice, like shuffle and repeat
					
		Hover effects on transparent image buttons
			Settings Button
			Volume button
			https://stackoverflow.com/questions/47765228/is-it-possible-to-set-tthe-hsv-for-a-color-adjust-via-css
		
		Loader status % complete thing
		
		Put a filter on images when in light theme to make them slightly grey (or dampen the actual images).
		
		Revisit fonts -- Do we need to include the font files? 
						
		~incomplete/Grizzly Bear
			F2 to show tag editor, no content in table
			
		Show something on art boxes to differentiate between artist and album, especially when drag & dropping
	
		Drag and drop from misc places to system
			playlist table -> m3u
			track table, history, queue, info windows, current table -> single tracks
			album table -> folder
			
		Consistent in-program hotkeys & tab in settings window for in-program hotkeys. 
	
		Stylesheet issues
			Dec 12, 2017 00:02:44 AM javafx.css calculateValue
			WARNING: Could not resolve '-fx-control-inner-background' while resolving lookups for '-fx-highlight-fill' from rule '*.text-input' in stylesheet jar:file:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar!/com/sun/javafx/scene/control/skin/modena/modena.bss
			
			Dec 12, 2017 00:02:44 AM javafx.css calculateValue
			WARNING: Could not resolve '-fx-text-inner-color' while resolving lookups for '-fx-text-fill' from rule '*.text-input' in stylesheet jar:file:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar!/com/sun/javafx/scene/control/skin/modena/modena.bss
			
			Dec 12, 2017 00:02:44 AM javafx.css calculateValue
			WARNING: Could not resolve '-fx-text-inner-color' while resolving lookups for '-fx-highlight-text-fill' from rule '*.text-input' in stylesheet jar:file:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar!/com/sun/javafx/scene/control/skin/modena/modena.bss
			
			Dec 12, 2017 00:02:44 AM javafx.css calculateValue
			WARNING: Could not resolve '-fx-text-box-border' while resolving lookups for '-fx-background-color' from rule '*.text-input' in stylesheet jar:file:/usr/lib/jvm/java-8-openjdk-amd64/jre/lib/ext/jfxrt.jar!/com/sun/javafx/scene/control/skin/modena/modena.bss
			
			Dec 12, 2017 00:02:44 AM javafx.css calculateValue
			WARNING: Could not resolve '-fx-control-inner-background' while resolving lookups for '-fx-prompt-text-fill' from rule '*.text-input' in stylesheet file:////d/programming/workspace/MusicPlayer/stage/resources/style-dark.css
			
	https://www.freedesktop.org/software/appstream/docs/chap-Quickstart.html#sect-Quickstart-DesktopApps
			
	Tag auto fix button
	
	I don't like the way the library line wraps in the manifest. Can we make this nicer in ant? 
	
		
	Ok this should address a number of issues that people have been having including this one. Please test and let me know if this issue can be closed.
		JNativeHook-2.1.1-rc  
			https://oss.sonatype.org/content/repositories/snapshots/com/1stleg/jnativehook/2.1.SNAPSHOT/jnativehook-2.1.20170730.201417-33.jar
		JNativeHook-2.0.4-rc  
			https://oss.sonatype.org/content/repositories/snapshots/com/1stleg/jnativehook/2.0.SNAPSHOT/jnativehook-2.0.20170730.201637-41.jar




	
JavaFX stuff
	
	DND Error that doesn't do any harm
		Exception in thread "JavaFX Application Thread" java.lang.RuntimeException: dndGesture.dragboard is null in dragDropEnd
			at javafx.scene.Scene$DragSourceListener.dragDropEnd(Scene.java:3310)
			at com.sun.javafx.tk.quantum.GlassScene$1.lambda$actionPerformed$0(GlassScene.java:254)
			at java.security.AccessController.doPrivileged(Native Method)
			at com.sun.javafx.tk.quantum.GlassScene$1.actionPerformed(GlassScene.java:251)
			at com.sun.glass.ui.Clipboard.actionPerformed(Clipboard.java:173)
			at com.sun.glass.ui.gtk.GtkDnDClipboard.pushToSystem(GtkDnDClipboard.java:41)
			at com.sun.glass.ui.SystemClipboard.flush(SystemClipboard.java:51)
			at com.sun.glass.ui.ClipboardAssistance.flush(ClipboardAssistance.java:59)
			at com.sun.javafx.tk.quantum.QuantumClipboard.flush(QuantumClipboard.java:274)
			at com.sun.javafx.tk.quantum.QuantumToolkit.startDrag(QuantumToolkit.java:1224)
			at javafx.scene.Scene$DnDGesture.dragDetectedProcessed(Scene.java:2953)
			at javafx.scene.Scene$DnDGesture.process(Scene.java:3022)
			at javafx.scene.Scene$DnDGesture.access$8200(Scene.java:2909)
			at javafx.scene.Scene$MouseHandler.process(Scene.java:3773)
			at javafx.scene.Scene$MouseHandler.access$1500(Scene.java:3485)
			at javafx.scene.Scene.impl_processMouseEvent(Scene.java:1762)
			at javafx.scene.Scene$ScenePeerListener.mouseEvent(Scene.java:2494)
			at com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:381)
			at com.sun.javafx.tk.quantum.GlassViewEventHandler$MouseEventNotification.run(GlassViewEventHandler.java:295)
			at java.security.AccessController.doPrivileged(Native Method)
			at com.sun.javafx.tk.quantum.GlassViewEventHandler.lambda$handleMouseEvent$2(GlassViewEventHandler.java:417)
			at com.sun.javafx.tk.quantum.QuantumToolkit.runWithoutRenderLock(QuantumToolkit.java:389)
			at com.sun.javafx.tk.quantum.GlassViewEventHandler.handleMouseEvent(GlassViewEventHandler.java:416)
			at com.sun.glass.ui.View.handleMouseEvent(View.java:555)
			at com.sun.glass.ui.View.notifyMouse(View.java:937)
			at com.sun.glass.ui.gtk.GtkApplication._runLoop(Native Method)
			at com.sun.glass.ui.gtk.GtkApplication.lambda$null$5(GtkApplication.java:139)
			at java.lang.Thread.run(Thread.java:748)
			
	Tray Icon
		I have a few demos that are all terrible. It looks like we need to wait for JavaFX to get this going for us. 
		Or maybe just show an icon with no menus. Kinda hate that. How do we exit? 
		Gnome 3 doesn't support. Code works but creates a bad entry on taskbar.
		What systems do support? 
		What other systems don't support? How to handle? 
		https://stackoverflow.com/questions/29995727/java-systemtray-icon-does-not-always-work
		
	hide/show via hotkeys while maximized toggles every 3 presses instead of every 2 presses. 
		https://stackoverflow.com/questions/45269173/stage-seticonified-and-stage-isiconified-not-acting-properly
				
	Showing any dialog prevents window drag resize. 
		http://bugs.java.com/bugdatabase/view_bug.do?bug_id=8140491
		https://stackoverflow.com/questions/33134791/javafx-stage-cant-be-resized-after-showing-a-dialog
	
	While loading the library, the table view scrolls a little bit. 
	
	Tiny drop shadow on transport buttons when in dark theme. It's the line HBox, VBox, #transport { ... -fx-background-color: #222222 ... }
	
	Table header alignment:
		Platform.runLater(() -> tableView.refresh());
		https://stackoverflow.com/questions/37423748/javafx-tablecolumns-headers-not-aligned-with-cells-due-to-vertical-scrollbar
	
	
Refactor / organize my code. 
 	Make LibraryUpdater part of Library. Is there a way to abstract out the Platform -> RunLater part? I feel like we're just stuck w/ that, which kind of ties to us JavaFX. 
 		Maybe ui.runMe ( Runnable ), and then the UI can decide whether to launch a new thread, have a thread idling, do it on this thread, or use something like Platform.runLater()	

 	Make MainWindow its own class, and have FXUI be more of a simple manager? 
 	
	use observable values for all of the track and album stuff, so we don't have to do refreshes
	
	a better structure for persister
	
	a better structure for hotkey commands (maybe combine with commandline commands?)
	
	Move all the file browser calls into a single function
	
	Make a single function for setting up right click menus, or at least combine a bunch. We have so many big chunks of the same code. 

Decoders

	Play mounted audio cd
		http://www.jsresources.org/examples/CddaPlayer.java.html

	Trying to play back https://archive.org/download/testmp3testfile/mpthreetest.mp3 using 
	http://hypnosplayer.org/download/beta1/Hypnos-nix-64bit-beta1.AppImage on Xubuntu 16.04 gives a very high-pitch voice, not how it should sound.
	
	Mp4
		buffered input stream on the random access File stream
		
	Ogg
		Works, seeking is done using read() instead of skip(), so it's a little slow.
		
	m4b - Fast play for some reason
		https://stackoverflow.com/questions/44750751/why-are-m4bs-playing-at-faster-speeds
		I need to set the sample rate to one of these: 96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350 
		The files seem te report the wrong sample rate. JAAD acutally reads them. 
		
	Flac
		Can we get flacplayer.java to play things that we need jflac for:
			Adrian Orange
			A Perfect Circle - Mer de noms
			Pink Floyd - Pulse (disc 1)
			
		buffered input stream on the random access File stream
		
	Test Cases
		organfinale.wav
			No line matching interface SourceDataLine supporting format PCM_FLOAT 44100.0 Hz, 32 bit, stereo, 8 bytes/frame,  is supported.
			at javax.sound.sampled.AudioSystem.getLine(AudioSystem.java:479)
			at net.joshuad.musicplayer.players.WavPlayer.openStreamsAtRequestedOffset(WavPlayer.java:133)
		
		Leonard Cohen - You want it Darker
			No volume control

		three-silver.ogg
			Long files take a long time to seek
			Long load time
			
		normal.wav
			Slow seek
			
		c304-2.wav
			Slow load, slow seek
		
		long.m4a
			No load

		normal.ogg
			Trouble seeking
		
	Wav
		BufferedInputStream

OS Specific		
	All:
		https://stackoverflow.com/questions/7506329/embed-java-into-a-c-application

	Windows
		Open-with shell integration
		Installer
	    Standalone build (32-bit)
		Rename java process to Hypnos
		
	Linux
		use a compiled launcher rather than a script -- this will make the appimage nicer I think
		Rename java process to Hypnos
		
		Gnome3 
			Right click -> Open with -- loads the files to current list, but doesn't start playing. 
			
		Always use Dejavu font? 
	
	OSX
		Does our package work? 
		Open-with shell integration
		.DMG installer
		Rename java process to Hypnos ?
		
		Always use LucidaGrande font?
		Test global hotkeys
	
Some exceptions don't show in log. Looks like javafx thread stuff.
		Exception in thread "JavaFX Application Thread" java.lang.NullPointerException
		at net.joshuad.hypnos.fxui.FormattedAlbumCell.updateItem(Unknown Source)
		at net.joshuad.hypnos.fxui.FormattedAlbumCell.updateItem(Unknown Source)
		at javafx.scene.control.TableCell.updateItem(TableCell.java:663)
		at javafx.scene.control.TableCell.indexChanged(TableCell.java:468)
		at javafx.scene.control.IndexedCell.updateIndex(IndexedCell.java:116)
		at com.sun.javafx.scene.control.skin.TableRowSkinBase.updateCells(TableRowSkinBase.java:533)
		at com.sun.javafx.scene.control.skin.TableRowSkinBase.init(TableRowSkinBase.java:147)
		at com.sun.javafx.scene.control.skin.TableRowSkin.<init>(TableRowSkin.java:64)
		at javafx.scene.control.TableRow.createDefaultSkin(TableRow.java:212)
		at javafx.scene.control.Control.impl_processCSS(Control.java:872)
		at javafx.scene.Node.processCSS(Node.java:9058)
		at javafx.scene.Node.applyCss(Node.java:9155)
		at com.sun.javafx.scene.control.skin.VirtualFlow.setCellIndex(VirtualFlow.java:1964)
		at com.sun.javafx.scene.control.skin.VirtualFlow.getCell(VirtualFlow.java:1797)
		at com.sun.javafx.scene.control.skin.VirtualFlow.getCellLength(VirtualFlow.java:1879)
		at com.sun.javafx.scene.control.skin.VirtualFlow.computeViewportOffset(VirtualFlow.java:2528)
		at com.sun.javafx.scene.control.skin.VirtualFlow.layoutChildren(VirtualFlow.java:1189)
		at javafx.scene.Parent.layout(Parent.java:1087)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Parent.layout(Parent.java:1093)
		at javafx.scene.Scene.doLayoutPass(Scene.java:552)
		at javafx.scene.Scene$ScenePulseListener.pulse(Scene.java:2397)
		at com.sun.javafx.tk.Toolkit.lambda$runPulse$3(Toolkit.java:355)
		at java.security.AccessController.doPrivileged(Native Method)
		at com.sun.javafx.tk.Toolkit.runPulse(Toolkit.java:354)
		at com.sun.javafx.tk.Toolkit.firePulse(Toolkit.java:381)
		at com.sun.javafx.tk.quantum.QuantumToolkit.pulse(QuantumToolkit.java:510)
		at com.sun.javafx.tk.quantum.QuantumToolkit.pulse(QuantumToolkit.java:490)
		at com.sun.javafx.tk.quantum.QuantumToolkit.lambda$runToolkit$11(QuantumToolkit.java:319)
		at com.sun.glass.ui.InvokeLaterDispatcher$Future.run(InvokeLaterDispatcher.java:95)
		at com.sun.glass.ui.gtk.GtkApplication._runLoop(Native Method)
		at com.sun.glass.ui.gtk.GtkApplication.lambda$null$5(GtkApplication.java:139)
		at java.lang.Thread.run(Thread.java:748)
	Exception in thread "JavaFX Application Thread" java.lang.NullPointerException
		at net.joshuad.hypnos.fxui.FormattedAlbumCell.updateItem(Unknown Source)
		at net.joshuad.hypnos.fxui.FormattedAlbumCell.updateItem(Unknown Source)
		at javafx.scene.control.TableCell.updateItem(TableCell.java:663)
		at javafx.scene.control.TableCell.indexChanged(TableCell.java:468)
		at javafx.scene.control.IndexedCell.updateIndex(IndexedCell.java:116)
		at com.sun.javafx.scene.control.skin.TableRowSkinBase.updateCells(TableRowSkinBase.java:533)
		at com.sun.javafx.scene.control.skin.TableRowSkinBase.init(TableRowSkinBase.java:147)
		at com.sun.javafx.scene.control.skin.TableRowSkin.<init>(TableRowSkin.java:64)
		at javafx.scene.control.TableRow.createDefaultSkin(TableRow.java:212)
		at javafx.scene.control.Control.impl_processCSS(Control.java:872)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.control.Control.impl_processCSS(Control.java:868)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.control.Control.impl_processCSS(Control.java:868)
		at javafx.scene.Node.processCSS(Node.java:9058)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Scene.doCSSPass(Scene.java:545)
		at javafx.scene.Scene.access$3600(Scene.java:159)
		at javafx.scene.Scene$ScenePulseListener.pulse(Scene.java:2392)
		at com.sun.javafx.tk.Toolkit.lambda$runPulse$3(Toolkit.java:355)
		at java.security.AccessController.doPrivileged(Native Method)
		at com.sun.javafx.tk.Toolkit.runPulse(Toolkit.java:354)
		at com.sun.javafx.tk.Toolkit.firePulse(Toolkit.java:381)
		at com.sun.javafx.tk.quantum.QuantumToolkit.pulse(QuantumToolkit.java:510)
		at com.sun.javafx.tk.quantum.QuantumToolkit.pulse(QuantumToolkit.java:490)
		at com.sun.javafx.tk.quantum.QuantumToolkit.lambda$runToolkit$11(QuantumToolkit.java:319)
		at com.sun.glass.ui.InvokeLaterDispatcher$Future.run(InvokeLaterDispatcher.java:95)
		at com.sun.glass.ui.gtk.GtkApplication._runLoop(Native Method)
		at com.sun.glass.ui.gtk.GtkApplication.lambda$null$5(GtkApplication.java:139)
		at java.lang.Thread.run(Thread.java:748)
	Exception in thread "JavaFX Application Thread" java.lang.NullPointerException
		at net.joshuad.hypnos.fxui.FormattedAlbumCell.updateItem(Unknown Source)
		at net.joshuad.hypnos.fxui.FormattedAlbumCell.updateItem(Unknown Source)
		at javafx.scene.control.TableCell.updateItem(TableCell.java:663)
		at javafx.scene.control.TableCell.indexChanged(TableCell.java:468)
		at javafx.scene.control.IndexedCell.updateIndex(IndexedCell.java:116)
		at com.sun.javafx.scene.control.skin.TableRowSkinBase.updateCells(TableRowSkinBase.java:533)
		at com.sun.javafx.scene.control.skin.TableRowSkinBase.init(TableRowSkinBase.java:147)
		at com.sun.javafx.scene.control.skin.TableRowSkin.<init>(TableRowSkin.java:64)
		at javafx.scene.control.TableRow.createDefaultSkin(TableRow.java:212)
		at javafx.scene.control.Control.impl_processCSS(Control.java:872)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.control.Control.impl_processCSS(Control.java:868)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.Parent.impl_processCSS(Parent.java:1280)
		at javafx.scene.control.Control.impl_processCSS(Control.java:868)
		at javafx.scene.Node.processCSS(Node.java:9058)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Node.processCSS(Node.java:9051)
		at javafx.scene.Scene.doCSSPass(Scene.java:545)
		at javafx.scene.Scene.access$3600(Scene.java:159)
		at javafx.scene.Scene$ScenePulseListener.pulse(Scene.java:2392)
		at com.sun.javafx.tk.Toolkit.lambda$runPulse$3(Toolkit.java:355)
		at java.security.AccessController.doPrivileged(Native Method)
		at com.sun.javafx.tk.Toolkit.runPulse(Toolkit.java:354)
		at com.sun.javafx.tk.Toolkit.firePulse(Toolkit.java:381)
		at com.sun.javafx.tk.quantum.QuantumToolkit.pulse(QuantumToolkit.java:510)
		at com.sun.javafx.tk.quantum.QuantumToolkit.pulse(QuantumToolkit.java:490)
		at com.sun.javafx.tk.quantum.QuantumToolkit.lambda$runToolkit$11(QuantumToolkit.java:319)
		at com.sun.glass.ui.InvokeLaterDispatcher$Future.run(InvokeLaterDispatcher.java:95)
		at com.sun.glass.ui.gtk.GtkApplication._runLoop(Native Method)
		at com.sun.glass.ui.gtk.GtkApplication.lambda$null$5(GtkApplication.java:139)
		at java.lang.Thread.run(Thread.java:748)
			

